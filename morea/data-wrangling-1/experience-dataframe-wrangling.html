<!DOCTYPE html>
<html lang="en">
<head>
  <title> Change-HI/EDU | 4. Wrangling DataFrames </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8">

  <link rel="stylesheet" href="/css/themes/spacelab/bootstrap.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  <script src="https://kit.fontawesome.com/020726ec0d.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>

  

  <!-- Load JQuery, then use it to attach the class 'active' to navbar item currently displayed. -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script>
    $(window).on('load', function () {
      $('.nav-item').find('a[href="' + location.pathname + '"]').addClass('active');
    });
  </script>

</head>
<body>

<div class="navbar navbar-expand-lg fixed-top navbar-light bg-light">
  <div class="container">
    <a class="navbar-brand" href="/index.html"> Change-HI/EDU </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav">
        
        <li class="nav-item"><a class="nav-link" href="/modules/">Modules</a></li>
        
        <li class="nav-item"><a class="nav-link" href="/outcomes/">Outcomes</a></li>
        
        
        <li class="nav-item"><a class="nav-link" href="/readings/">Readings</a></li>
        
        
        <li class="nav-item"><a class="nav-link" href="/experiences/">Experiences</a></li>
        
        
        <li class="nav-item"><a class="nav-link" href="/assessments/">Assessments</a></li>
        
        
      </ul>
    </div>
  </div>
</div>

<!-- Internal fragment for displaying the breadcrumb bar -->
<div class="breadcrumb-background" style="padding-top: 1em; padding-bottom: .01em">
  <div class="container">
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        
        <li class="breadcrumb-item"><a href="/">Home</a></li>
        <li class="breadcrumb-item"><a href="/modules">Modules</a></li>
        <li class="breadcrumb-item"><a href="/modules/"></a></li>
        <li class="breadcrumb-item active">4. Wrangling DataFrames</li>
      </ol>
    </nav>
  </div>
</div>


<div class="container">
  <h1 id="4-wrangling-dataframes">4. Wrangling DataFrames</h1>

<div class="alert alert-success mt-3" role="alert">
  <p><i class="fa-solid fa-globe fa-xl"></i> <strong>Overview</strong></p>
  <hr />

  <p><strong>Questions</strong></p>
  <ul>
    <li>How can you select individual columns or rows from a <code class="language-plaintext highlighter-rouge">DataFrame</code>?</li>
    <li>How can you subset a <code class="language-plaintext highlighter-rouge">DataFrame</code>?</li>
    <li>How can you sort a <code class="language-plaintext highlighter-rouge">DataFrame</code>?</li>
  </ul>

  <p><strong>Objectives</strong></p>
  <ul>
    <li>Learn how to select specific columns or rows from a <code class="language-plaintext highlighter-rouge">DataFrame</code></li>
    <li>Learn how to select rows based on conditions.</li>
    <li>Learn how to sort a <code class="language-plaintext highlighter-rouge">DataFrame</code>’s rows or columns.</li>
  </ul>

</div>

<p><a href="https://mybinder.org/v2/gh/CI-TRACS/Data_Wrangling_with_Computational_Notebooks/HEAD"><img src="https://mybinder.org/badge_logo.svg" alt="Binder" /></a></p>

<h1 id="selection-subsetting-and-sorting-a-dataframe">Selection, Subsetting and Sorting a <code class="language-plaintext highlighter-rouge">DataFrame</code></h1>

<p>When exploring our data we will often want to focus our attention to specific rows, columns, and entries that satisfy certain conditions. We may want to either look at a single column of the data or work with a subset of the original data. This situation may occur because the source of your data was probably not using the information for the exact same purpose.</p>

<p>Furthermore, it is often helpful to sort our data set using a particular relation to identify patterns and to understand the data’s structure. For example, suppose the original data set we acquire and want to analyze describes a sport team’s performance for each game during a season and it is original ordered in chronological order. It may be interesting to sort the game play statistics using a different relation such as number of points scored to easily identify high and low scoring games.</p>

<p>As with previous episodes you should follow along in the notebook starting with ‘04’ that can be found at the following link <a href="https://mybinder.org/v2/gh/CI-TRACS/Data_Wrangling_with_Computational_Notebooks/HEAD">Link to Binder</a>.</p>

<h2 id="selection">Selection</h2>

<p>Selecting data from a <code class="language-plaintext highlighter-rouge">DataFrame</code> is very easy and builds on concepts we discussed in the previous episode. As mentioned previously, in a <code class="language-plaintext highlighter-rouge">DataFrame</code> we have column names called headers and row names called indexes. Depending on how we loaded the data these might be integers or some other ID.</p>

<p>If we have the example <code class="language-plaintext highlighter-rouge">DataFrame</code> seen in the image below we can select and/or subset various combinations of rows and columns by using Pandas.</p>

<figure>
  
    <img src="/morea/data-wrangling/fig/E4_1_selection_dataframe.png" style="max-width: 60%;" alt="/Selection%20DataFrame" class="img-fluid mx-auto d-block border" />
  
  <figcaption style="text-align: center">
    <small>
      
    </small>
  </figcaption>
</figure>

<h3 id="selecting-columns">Selecting Columns</h3>

<p>To start off lets focus on subsetting columns. If we have a <code class="language-plaintext highlighter-rouge">DataFrame</code> called <code class="language-plaintext highlighter-rouge">df</code> and a column called ‘ph’ we can subset the <code class="language-plaintext highlighter-rouge">DataFrame</code> using <code class="language-plaintext highlighter-rouge">df['ph']</code>.</p>

<div class="alert alert-secondary" role="alert">

  <h6 id="python">Python</h6>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">'ph'</span><span class="p">]</span>
</code></pre></div>  </div>

  <h6 id="output">Output</h6>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sample ID
Sample-1    7.951
Sample-2      NaN
Sample-3      NaN
Sample-4    7.780
Sample-5      NaN
Sample-6      NaN
Sample-7      NaN
Sample-8    7.496
Name: ph, dtype: float64
</code></pre></div>  </div>

</div>

<h3 id="selecting-rows">Selecting Rows</h3>

<p>If on the other hand we want to access a subset rows we have to use a slightly different approach. While previously we could just pass the name of the column inside brackets if we want to access one or more rows we need to use the <code class="language-plaintext highlighter-rouge">.loc</code> or <code class="language-plaintext highlighter-rouge">.iloc</code> methods.</p>

<p>So if we again have a <code class="language-plaintext highlighter-rouge">DataFrame</code> called <code class="language-plaintext highlighter-rouge">df</code> and a row called ‘Sample-1’ we can access it using <code class="language-plaintext highlighter-rouge">df.loc['Sample-1', df.columns]</code>.</p>

<div class="alert alert-secondary" role="alert">

  <h6 id="python-1">Python</h6>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'Sample-1'</span><span class="p">,</span> <span class="n">df</span><span class="p">.</span><span class="n">columns</span><span class="p">]</span>
</code></pre></div>  </div>

  <h6 id="output-1">Output</h6>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>date mmddyy     40610.0000
press dbar        239.8000
temp ITS-90        18.9625
csal PSS-78        35.0636
coxy umol/kg           NaN
ph                  7.9510
Name: Sample-1, dtype: float64
</code></pre></div>  </div>

</div>

<p>The key difference between <code class="language-plaintext highlighter-rouge">.loc</code> and <code class="language-plaintext highlighter-rouge">.iloc</code> is that <code class="language-plaintext highlighter-rouge">.loc</code> relies on the names of the indexes and headers while <code class="language-plaintext highlighter-rouge">.iloc</code> relies instead on the index and header number. Here <code class="language-plaintext highlighter-rouge">df.columns</code> is providing the all the header names in the <code class="language-plaintext highlighter-rouge">DataFrame</code> called <code class="language-plaintext highlighter-rouge">df</code> and letting pandas know that we want a single row, but all of the header in the <code class="language-plaintext highlighter-rouge">DataFrame</code>.</p>

<p>If we were to use <code class="language-plaintext highlighter-rouge">.iloc</code> instead of <code class="language-plaintext highlighter-rouge">.loc</code> for the previous example and we know that ‘Sample-1’ is at index position 0 we would use <code class="language-plaintext highlighter-rouge">df.iloc[0, :]</code> and get the same result. You might notice that we also had to change <code class="language-plaintext highlighter-rouge">df.columns</code> to <code class="language-plaintext highlighter-rouge">:</code> when we used <code class="language-plaintext highlighter-rouge">.iloc</code> this is because <code class="language-plaintext highlighter-rouge">df.columns</code> provides the names of all the headers which is fine to do with <code class="language-plaintext highlighter-rouge">.loc</code> but not <code class="language-plaintext highlighter-rouge">.iloc</code>.</p>

<div class="alert alert-secondary" role="alert">

  <h6 id="python-2">Python</h6>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</code></pre></div>  </div>

  <h6 id="output-2">Output</h6>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>date mmddyy     40610.0000
press dbar        239.8000
temp ITS-90        18.9625
csal PSS-78        35.0636
coxy umol/kg           NaN
ph                  7.9510
Name: Sample-1, dtype: float64
</code></pre></div>  </div>

</div>

<h2 id="the--operator">The <code class="language-plaintext highlighter-rouge">:</code> operator</h2>

<div class="alert alert-secondary" role="alert">

  <p>When used inside a bracket the <code class="language-plaintext highlighter-rouge">:</code> operator will return the range between the two values it is given. For example if we had a Python list <code class="language-plaintext highlighter-rouge">x</code> with the following values [‘a’, ‘b’, ‘c’, ‘d’, ‘e’] and wanted to select ‘b’, ‘c’, and ‘d’ we can do this very concisely using the <code class="language-plaintext highlighter-rouge">:</code> operator.</p>

  <h6 id="python-3">Python</h6>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'d'</span><span class="p">,</span> <span class="s">'e'</span><span class="p">]</span>
<span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div>  </div>

  <p>With the output:</p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['b', 'c', 'd']
</code></pre></div>  </div>

</div>

<h3 id="selecting-columns-and-rows-simultaneously">Selecting Columns and Rows Simultaneously</h3>

<p>As we saw in the previous section we can select one or more rows and/or columns to view. For example if we wanted to view the ‘ph’ entry of ‘Sample-1’ from the previous example we could use <code class="language-plaintext highlighter-rouge">.loc</code> in the following manner.</p>

<div class="alert alert-secondary" role="alert">

  <h6 id="python-4">Python</h6>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'Sample-1'</span><span class="p">,</span> <span class="s">'ph'</span><span class="p">]</span>
</code></pre></div>  </div>

  <h6 id="output-3">Output</h6>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>7.951
</code></pre></div>  </div>

</div>

<p>If we wanted to select multiple columns e.g. both the ‘ph’ and ‘Longitude’ columns we can change the code bit to fit our needs.</p>

<div class="alert alert-secondary" role="alert">

  <h6 id="python-5">Python</h6>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'Sample-1'</span><span class="p">,</span> <span class="p">[</span><span class="s">'ph'</span><span class="p">,</span> <span class="s">'Longitude'</span><span class="p">]]</span>
</code></pre></div>  </div>

  <h6 id="output-4">Output</h6>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>temp ITS-90    18.9625
ph              7.9510
Name: Sample-1, dtype: float64
</code></pre></div>  </div>

</div>

<h2 id="using-iloc">Using <code class="language-plaintext highlighter-rouge">.iloc</code></h2>

<p>You can just as well use <code class="language-plaintext highlighter-rouge">.iloc</code> for the two examples above, but you will need to change the index and headers to their respective integer values i.e. the row number(s) and the header number(s).</p>

<h2 id="subsetting">Subsetting</h2>

<p>Comparison operations (“&lt;” , “&gt;” , “==” , “&gt;=” , “&lt;=” , “!=”) can be applied to pandas <code class="language-plaintext highlighter-rouge">Series</code> and <code class="language-plaintext highlighter-rouge">DataFrame</code>s in the same vectorized fashion as arithmetic operations except the returned object is a <code class="language-plaintext highlighter-rouge">Series</code> or <code class="language-plaintext highlighter-rouge">DataFrame</code> of booleans (either <code class="language-plaintext highlighter-rouge">True</code> or <code class="language-plaintext highlighter-rouge">False</code>).</p>

<h3 id="within-a-single-dataframe">Within a Single <code class="language-plaintext highlighter-rouge">DataFrame</code></h3>

<p>To start let focus on a single <code class="language-plaintext highlighter-rouge">DataFrame</code> to better understand how comparison operations work in Pandas. As an example lets say that we have a <code class="language-plaintext highlighter-rouge">DataFrame</code> like the one below stored in <code class="language-plaintext highlighter-rouge">df</code>:</p>

<p>If we wanted to identify which of the above samples come from a depth above 380 we start by finding  column ‘press dbar’ using a less than condition of 380.</p>

<div class="alert alert-secondary" role="alert">

  <h6 id="python-6">Python</h6>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">'press dbar'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">380</span>
</code></pre></div>  </div>

  <p>The output will be a Pandas <code class="language-plaintext highlighter-rouge">Series</code> containing a boolean value for each row in the <code class="language-plaintext highlighter-rouge">df</code> that looks like this.</p>

  <h6 id="output-5">Output</h6>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sample ID
Sample-1     True
Sample-2     True
Sample-3     True
Sample-4     True
Sample-5     True
Sample-6    False
Sample-7    False
Sample-8    False
Name: press dbar, dtype: bool
</code></pre></div>  </div>

</div>

<p>We can see that the first row and the last row are both <code class="language-plaintext highlighter-rouge">True</code> while the remaining rows are <code class="language-plaintext highlighter-rouge">False</code> and a quick look at the original data confirms that this is correct based on our condition. However, looking back at the original <code class="language-plaintext highlighter-rouge">DataFrame</code> is very tedious. If we instead want to view/save the rows that were found to have a depth &lt; 380 we can either save the output <code class="language-plaintext highlighter-rouge">Series</code> to a variable and use that or directly place the previously used code within a bracket. Both methods are equivalent and shown below.</p>

<div class="alert alert-secondary" role="alert">

  <h6 id="python-7">Python</h6>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">good_rows</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'press dbar'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">380</span>
<span class="n">df</span><span class="p">[</span><span class="n">good_rows</span><span class="p">]</span>
</code></pre></div>  </div>

  <p>Is equivalent to:</p>

  <h6 id="python-8">Python</h6>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'press dbar'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">380</span><span class="p">]</span>
</code></pre></div>  </div>

  <p>Either of these code bits will generate the same output:</p>

  <h6 id="output-6">Output</h6>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>           date mmddyy  press dbar  temp ITS-90  csal PSS-78  coxy umol/kg     ph
Sample ID                                                                        
Sample-1         40610       239.8      18.9625      35.0636           NaN  7.951
Sample-2         40610       280.7      16.1095      34.6103         192.3    NaN
Sample-3         40610       320.1      12.9729      34.2475         190.8    NaN
Sample-4         40610       341.3      11.9665      34.1884         191.3  7.780
Sample-5         40610       360.1      11.3636      34.1709         203.5    NaN
</code></pre></div>  </div>

</div>

<p>It might seem strange that we don’t need to use <code class="language-plaintext highlighter-rouge">.loc</code> or <code class="language-plaintext highlighter-rouge">.iloc</code> despite the fact that we are selecting rows. This is due to the fact that the output of <code class="language-plaintext highlighter-rouge">df['press dbar'] &lt; 380</code> is a Pandas <code class="language-plaintext highlighter-rouge">Series</code> that contains information on the row and Pandas inherently assumes that when it is passed a boolean list like this that we want to select those rows that are <code class="language-plaintext highlighter-rouge">True</code>. A graphic example of this is shown below.</p>

<figure>
  
    <img src="/morea/data-wrangling/fig/E4_2_filter_dataframe.png" style="max-width: 60%;" alt="/Filter%20DataFrame" class="img-fluid mx-auto d-block border" />
  
  <figcaption style="text-align: center">
    <small>
      
    </small>
  </figcaption>
</figure>

<p>From previous Pandas Data Wrangling workshop (<a href="https://github.com/hawaiidatascience/pandas_data_wrangling/blob/master/4_Subsetting_and_Sorting.ipynb">Link to Github</a>).</p>

<h2 id="column-specification">Column Specification</h2>

<p>If you do not specify a column to compare and instead do e.g. <code class="language-plaintext highlighter-rouge">df.loc[:] &lt; df2.loc[:]</code> you will get a comparison of every column and a <code class="language-plaintext highlighter-rouge">DataFrame</code> containing those values as an output:</p>

<div class="alert alert-secondary" role="alert">

  <h6 id="python-9">Python</h6>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[:]</span> <span class="o">&lt;</span> <span class="n">df2</span><span class="p">.</span><span class="n">loc</span><span class="p">[:]</span>
</code></pre></div>  </div>

  <h6 id="output-7">Output</h6>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>           date mmddyy  press dbar  temp ITS-90  csal PSS-78  coxy umol/kg     ph
Sample ID                                                                        
Sample-1          True       False         True         True         False  False
Sample-2          True       False         True         True          True  False
Sample-3          True       False         True         True          True  False
Sample-4          True       False         True         True          True   True
Sample-5          True       False         True         True         False  False
Sample-6          True       False         True         True          True  False
Sample-7          True       False         True         True          True  False
Sample-8          True       False         True         True          True  False
</code></pre></div>  </div>

</div>

<h2 id="sorting">Sorting</h2>

<p>There may also come a time when we want to see the data sorted by some criterion in order to explore potential patterns and order statistics of the entries based on a relation. For example, we might want to order a <code class="language-plaintext highlighter-rouge">DataFrame</code> by the depth that a sample was recovered from. <strong>Note: we can also sort the order of the columns based on their names</strong></p>

<p>There are two primary methods to sort a <code class="language-plaintext highlighter-rouge">DataFrame</code> either by the index or by a value. The index is rather straight forward, you use the method <code class="language-plaintext highlighter-rouge">sort_index()</code> to sort the <code class="language-plaintext highlighter-rouge">DataFrame</code> and provide an axis (0=row, 1=columns). We can reuse <code class="language-plaintext highlighter-rouge">df</code> and since the index is already sorted we can sort the order of the columns instead.</p>

<div class="alert alert-secondary" role="alert">

  <h6 id="python-10">Python</h6>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>  </div>

  <h6 id="output-8">Output</h6>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>           coxy umol/kg  csal PSS-78  date mmddyy     ph  press dbar  temp ITS-90
Sample ID                                                                        
Sample-1            NaN      35.0636        40610  7.951       239.8      18.9625
Sample-2          192.3      34.6103        40610    NaN       280.7      16.1095
Sample-3          190.8      34.2475        40610    NaN       320.1      12.9729
Sample-4          191.3      34.1884        40610  7.780       341.3      11.9665
Sample-5          203.5      34.1709        40610    NaN       360.1      11.3636
Sample-6          193.7      34.1083        40610    NaN       385.0      10.4636
Sample-7          156.5      34.0567        40610    NaN       443.7       8.5897
Sample-8          110.7      34.0424        40610  7.496       497.8       7.1464
</code></pre></div>  </div>

</div>

<p>Here we can see that we’ve ordered the columns alphabetically.</p>

<p>If we want to instead order the <code class="language-plaintext highlighter-rouge">DataFrame</code> based on the value in a particular column or row we instead use <code class="language-plaintext highlighter-rouge">sort_values()</code>. We can again use the pressure i.e. ‘press dbar’ column as an example and sort the rows by greatest to smallest pressure value.</p>

<div class="alert alert-secondary" role="alert">

  <h6 id="python-11">Python</h6>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'press dbar'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div>  </div>

  <p>Will produce the reorder <code class="language-plaintext highlighter-rouge">DataFrame</code> as the output:</p>

  <h6 id="output-9">Output</h6>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>           date mmddyy  press dbar  temp ITS-90  csal PSS-78  coxy umol/kg     ph
Sample ID                                                                        
Sample-8         40610       497.8       7.1464      34.0424         110.7  7.496
Sample-7         40610       443.7       8.5897      34.0567         156.5    NaN
Sample-6         40610       385.0      10.4636      34.1083         193.7    NaN
Sample-5         40610       360.1      11.3636      34.1709         203.5    NaN
Sample-4         40610       341.3      11.9665      34.1884         191.3  7.780
Sample-3         40610       320.1      12.9729      34.2475         190.8    NaN
Sample-2         40610       280.7      16.1095      34.6103         192.3    NaN
Sample-1         40610       239.8      18.9625      35.0636           NaN  7.951
</code></pre></div>  </div>

</div>

<div class="alert alert-success mt-3" role="alert">
  <p><i class="fa-solid fa-globe fa-xl"></i> <strong>Key Points</strong></p>
  <hr />

  <ul>
    <li>Select columns by using <code class="language-plaintext highlighter-rouge">[\"column name\"]</code> or rows by using the <code class="language-plaintext highlighter-rouge">loc</code> attribute.</li>
    <li>Sort based on values in a column by using the <code class="language-plaintext highlighter-rouge">sort_values</code> method.</li>
  </ul>
</div>

<div class="alert alert-secondary" role="alert">
  <p><i class="fa-solid fa-user-pen fa-xl"></i>  <strong>Exercise: Subsetting a Data Set</strong></p>
  <hr />

  <p>Try it yourself! Going back to our <code class="language-plaintext highlighter-rouge">20_sales_records.xlsx</code> file, idenitfy which orders are <code class="language-plaintext highlighter-rouge">Online</code> and <code class="language-plaintext highlighter-rouge">High Priority</code></p>

  <ul>
    <li>Read the first couple rows to get a sense of the data. Which column reflects <code class="language-plaintext highlighter-rouge">Online</code> or <code class="language-plaintext highlighter-rouge">Offline</code> Status.</li>
    <li>A <code class="language-plaintext highlighter-rouge">High Priority</code> order is denoted by <code class="language-plaintext highlighter-rouge">H</code> in one of the columns. Identify which column.</li>
    <li>HINT: Use the loc method</li>
  </ul>

  <details>
  <summary>Solution</summary>

 First, we read in the first few lines of our data set to identify which columns we want to filter on. We want `Online` orders of `High Priority`
  
  <pre>
  df = pd.read_excel('data/20_sales_records.xlsx', nrows=5)
  df
  </pre>

From the first few rows of data, we see that the column "Sales Channel" describes online/offline status and "Order Priority" describes order priority.

So we use loc along with a combination of conditionals to subset our DataFrame for rows with "Online" entries of "Sales Channel" and "H" level "Order Priority".

  <pre>
  df.loc[(df['Sales Channel'] == 'Online') &amp; (df['Order Priority'] == 'H')]
  </pre>

The resulting subset should show rows 7, 9, and 10 only.


Below shows how our subsetted `DataFrame` now looks:
<figure>
  
    <img src="/morea/data-wrangling/fig/E4_5_exercise.png" style="max-width: 40%;" alt="/Output%20DataFrame" class="img-fluid mx-auto d-block border" />
  
  <figcaption style="text-align: center">
    <small>
      
    </small>
  </figcaption>
</figure>

</details>
</div>

<div style="text-align: right; padding-bottom: 10px">
  <hr />
  <button type="button" onclick="window.location='/morea/data-wrangling/experience-dataframe-analysis.html'" class="btn btn-primary">
    <p style="font-size:16px; margin: 0">5. Dataframe Analysis -&gt;</p>
    <p style="font-size:12px; margin: 0">2:50pm</p>
    </button>
</div>


</div>




<!-- Maybe find a different way?
<script src="/js/scrollIfAnchor.js"></script>
-->

<footer class="footer footer-background" style="padding-top: 1em; padding-bottom: 1em">
  <div class="container text-center">
    
    

    
    <p style="margin: 0">Powered by the <a class="footer-link" href="https://morea-framework.github.io/">Morea Framework</a> (Theme: spacelab)<br>
      Last update on: <span>2023-10-05 19:51:18 -1000</span></p>

    <p style="margin: 0">
      
      18 modules
      
      | 17 outcomes
      
      
      | 53 readings
      
      
      | 92 experiences
      
      
      | 13 assessments
      
    </p>
  </div>
</footer>


<!-- Load Bootstrap JavaScript components -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>


<script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML">
</script>


<!-- Add anchors to pages. -->
<script>anchors.add();</script>


</body>
</html>
